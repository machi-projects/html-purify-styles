"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(function(a){var b=a.prototype,c=b.parseFromString;try{if(new a().parseFromString("","text/html"))return}catch(d){}b.parseFromString=function(d,e){if(/^\s*text\/html\s*(?:;|$)/i.test(e)){var f=document.implementation.createHTMLDocument("");return-1<d.toLowerCase().indexOf("<!doctype")?f.documentElement.innerHTML=d:f.body.innerHTML=d,f}return c.apply(this,arguments)}})(DOMParser);var PurifyHtmlStyles=function(){function a(b){_classCallCheck(this,a),this.xml=b}return a.prototype.parser=function(c){var d=null;if(window.DOMParser){var b=new DOMParser;d=b.parseFromString(c,"text/html")}else window.ActiveXObject&&(d=new ActiveXObject("Microsoft.XMLDOM"),d.async=!1,d.loadXML(c));return d},a.prototype.createKey=function(){var c=Math.random().toString(36).substr(2,6);return"sty__"+c+"__cls"},a.prototype.groupStyleTagRules=function(c){for(var d={},e=[],g=0;g<c.length;g++)for(var h=c[g],l=h.sheet.cssRules||h.sheet.rules,m=0,n=l.length;m<n;m++){var o=l[m],p=o.selectorText,q=d[p],s=o.style.cssText;d[p]=q?q+s:s}for(var t in d)e.push(t);return{selectors:e,rules:d}},a.prototype.mergeStyles=function(c){for(var g,d=c.trim().split(";"),e={},f=0;f<d.length;f++)if(g=d[f].trim(),g){var h=g.split(":"),l=h[0].trim(),m=h[1].trim();e[l]=m}var n="";for(var o in e)n+=o+": "+e[o]+";";return n},a.prototype.run=function(){var c=this.parser("<div id='purifyStyleMyStyler'></div>"),d=c.getElementById("purifyStyleMyStyler");d.innerHTML=this.xml;for(var e=c.querySelectorAll("[data-css-purify-styler]"),f=Object.assign({},this.groupStyleTagRules(e)),g=f.selectors,h=f.rules,l=c.querySelectorAll("[style]"),m=0;m<l.length;m++){var n=l[m],o=n.getAttribute("style");if(o){var p=(n.className||"").trim(),q=("."+p.replace(/ /g," .")).split(" "),s="",t=q.some(function(C){var D=g.indexOf(C);return s=g[D],0<=D}),u=s?s:"."+this.createKey(),v=h[s]||"";h[u]=v?this.mergeStyles(v+o):o;var w=p?" ":"",x=u.replace(".","");n.className+=-1==p.indexOf(x)?w+x:""}n.removeAttribute("style")}var y="";for(var z in h){var A=h[z];y+=z+"{"+A+"}\n"}var B=c.createElement("style");return B.type="text/css",B.setAttribute("data-css-purify-styler",Date.now()),B.appendChild(document.createTextNode("")),B.innerHTML=y,Array.prototype.forEach.call(e,function(C){C.parentNode.removeChild(C)}),d.appendChild(B),d.innerHTML},a}();
